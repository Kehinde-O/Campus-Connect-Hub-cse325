@inherits LayoutComponentBase
@using CampusConnectHub.Client.Services
@inject AuthService AuthService

<a href="#main-content" class="skip-link">Skip to main content</a>
<div class="page">
    <div class="sidebar">
        <NavMenu />
    </div>

    <main id="main-content">
        <div class="top-row px-4">
            @if (isAuthenticated)
            {
                <span class="user-greeting">Welcome, @userName!</span>
            }
            <a href="https://learn.microsoft.com/aspnet/core/" target="_blank" aria-label="Learn about ASP.NET Core (opens in new tab)">About</a>
        </div>

        <article class="content px-4">
            @Body
        </article>
    </main>
</div>

@code {
    private bool isAuthenticated = false;
    private string userName = "";

    protected override async Task OnInitializedAsync()
    {
        isAuthenticated = await AuthService.IsAuthenticatedAsync();
        if (isAuthenticated)
        {
            var user = await AuthService.GetUserAsync();
            userName = user?.FirstName ?? "User";
        }
    }
}

<style>
    .user-greeting {
        color: var(--text-secondary);
        font-weight: 500;
        margin-right: auto;
    }
</style>
