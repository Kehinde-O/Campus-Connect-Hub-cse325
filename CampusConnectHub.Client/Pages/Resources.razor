@page "/resources"
@using CampusConnectHub.Client.Services
@using CampusConnectHub.Shared.DTOs
@inject ApiService ApiService

<PageTitle>Resources - Campus Connect Hub</PageTitle>

<div class="content-header text-center mb-4">
    <h1 class="display-4 fw-bold text-primary">Campus Resources</h1>
    <p class="lead text-secondary">Quick links to essential campus services</p>
</div>

<div class="container-fluid resources-container">
    @if (isLoading)
    {
        <div class="d-flex flex-column align-items-center justify-content-center py-5">
            <div class="loading-spinner mb-3"></div>
            <p class="text-secondary">Loading resources...</p>
        </div>
    }
    else if (resources.Any())
    {
        <div class="dashboard-grid">
            @foreach (var resource in resources)
            {
                <a href="@resource.Url" target="_blank" class="card resource-card h-100 text-decoration-none" rel="noopener noreferrer">
                    <div class="card-body text-center d-flex flex-column align-items-center">
                        <div class="resource-icon-wrapper mb-3">
                            <i class="bi @GetCategoryIconClass(resource.Category) fs-2 text-white"></i>
                        </div>
                        <h3 class="card-title h5 text-primary mb-2">@resource.Title</h3>
                        <p class="card-text text-secondary small flex-grow-1 mb-3">@resource.Description</p>
                        
                        <div class="w-100 mt-auto pt-3 border-top d-flex justify-content-between align-items-center">
                            <span class="badge bg-secondary text-primary">@resource.Category</span>
                            <i class="bi bi-box-arrow-up-right text-primary"></i>
                        </div>
                    </div>
                </a>
            }
        </div>
    }
    else
    {
        <div class="empty-state text-center py-5">
            <div class="empty-icon mb-3">
                <i class="bi bi-folder-x display-1 text-tertiary"></i>
            </div>
            <h3 class="text-primary mb-2">No resources available</h3>
            <p class="text-secondary">Resources will appear here when they're added!</p>
        </div>
    }
</div>

@code {
    private List<ResourceDto> resources = new();
    private bool isLoading = true;

    protected override async Task OnInitializedAsync()
    {
        await LoadResources();
    }

    private async Task LoadResources()
    {
        isLoading = true;
        try
        {
            resources = await ApiService.GetResourcesAsync();
        }
        catch
        {
            resources = new List<ResourceDto>();
        }
        finally
        {
            isLoading = false;
        }
    }

    private string GetCategoryIconClass(string category)
    {
        return category?.ToLower() switch
        {
            "academic" => "bi-book-half",
            "library" => "bi-journal-richtext",
            "student services" => "bi-person-badge",
            "health" => "bi-heart-pulse-fill",
            "dining" => "bi-cup-hot-fill",
            "housing" => "bi-house-door-fill",
            "technology" => "bi-laptop",
            "sports" => "bi-trophy-fill",
            "counseling" => "bi-chat-heart-fill",
            _ => "bi-link-45deg"
        };
    }
}

<style>
    .resources-container {
        max-width: 1200px;
        margin: 0 auto;
    }

    .resource-card {
        transition: transform 0.2s ease, box-shadow 0.2s ease;
        border: 1px solid rgba(0,0,0,0.05);
    }
    
    .resource-card:hover {
        transform: translateY(-4px);
        box-shadow: var(--shadow-lg);
    }

    .resource-icon-wrapper {
        width: 60px;
        height: 60px;
        background: linear-gradient(135deg, var(--primary-gradient-start) 0%, var(--primary-gradient-end) 100%);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: var(--shadow-md);
        transition: transform 0.2s ease;
    }
    
    .resource-card:hover .resource-icon-wrapper {
        transform: scale(1.1) rotate(5deg);
    }

    .text-tertiary {
        color: var(--text-tertiary);
    }
</style>
